<!-- Content Header (Page header) -->
<section class="content-header">
    <h1>
        设置领导
        <small>设置领导</small>
    </h1>
</section>

<section class="content">
    <div class="row">
        <div class="col-md-12">
            <div class="inline pull-right"style="margin-right: 10px;">
                <button type="button" class="btn btn-success btn-block"
                        e-event="href:/system/organization/addleader?tpl=addrow"
                        e-permission="core_organization_edit"
                        >
                <i class="fa fa-plus"></i>&nbsp;&nbsp;添加领导
                </button>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-12">
            <div class="box-body" style="max-height: 520px; overflow: auto;">
                <table class="table table-bordered table-hover no-footer" id="leaderset">
                    <thead>
                        <tr>
                            <th style="text-align:center;">本级领导</th>
                            <th style="text-align:center;">上级领导</th>
                            <th style="text-align:center;">岗位</th>
                            <th style="text-align:center;">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                    {{if data.leaders && (data.leaders).length > 0}}
                        {{each data.leaders as leader i}}
                            <tr id="leader_{{i}}">
                                <td>
                                    <e-poptreelist id="leader_agency_{{i}}" name="leader_agency"
                                                   e-tree-url="/system/organization/leader/list"
                                                   e-list-url="/system/core/user/leader/list"
                                                   e-option-value="account" e-option-text="name"
                                                   e-option-text-title="名称"  e-title="选择本级领导"
                                                   e-data-id="id" e-data-parent-id="pId"
                                                   e-display-columns="account,name,orgName"
                                                   e-display-columnnames="登录账户,用户名称,所属机构"
                                                   e-chkbox-type="1"
                                                   e-expand-level="0"
                                                   e-value="{{leader.agencyLeaderAccount}}"
                                                   {{if leader.agencyLeaderAccount}}
                                                   e-value-name-url="/system/core/user/getByLoginName?loginName={{leader.agencyLeaderAccount}}"
                                                   {{/if}}
                                                   e-width="1000px"
                                                   e-height="650px"
                                                   e-com-height="500px"
                                                   e-z-index="99"
                                                   e-query-param = "search_LIKE_name"
                                                   e-query-param-name = "用户名称"
                                                   e-query-tree-list-param = "id:search_LIKE_organization.orgPath"
                                                   e-on-check="/system/organization/leaderSelect?index={{i}}"
                                    >
                                    </e-poptreelist>
                                </td>
                                <td>
                                    <e-poptreelist id="leader_parent_{{i}}" name="leader_parent"
                                                   e-tree-url="/system/core/post/list"
                                                   e-list-url="/system/core/user/query"
                                                   e-option-value="account" e-option-text="name"
                                                   e-option-text-title="名称"  e-title="选择上级领导"
                                                   e-data-id="code" e-data-parent-id="pCode"
                                                   e-display-columns="account,name"
                                                   e-display-columnnames="登录账户,用户名称"
                                                   e-chkbox-type="1"
                                                   e-expand-level="0"
                                                   e-z-index="99"
                                                   e-value="{{leader.parentLeaderAccount}}"
                                                   {{if leader.parentLeaderAccount}}
                                                   e-value-name-url="/system/core/user/getByLoginName?loginName={{leader.parentLeaderAccount}}"
                                                    {{/if}}
                                                    e-width="1000px" e-height="650px" e-com-height="600px"
                                                    e-query-param = "search_LIKE_name"
                                                    e-query-param-name = "用户名称"
                                                    e-query-tree-list-param = "code:postId"
                                                    e-on-selected="/system/organization/addParentLeaderType?index={{i}}"
                                    >
                                    </e-poptreelist>
                                    <input type='hidden' value='{{leader.parentLeaderType}}' name="parentLeaderType"/>
                                </td>
                                <td>
                                    <e-select id="leader_type_{{i}}" class="form-control" name="leaderType"  e-option-value="code" e-option-text="name" e-url="system/core/user/queryposts/{{leader.agencyLeaderAccount}}" e-value='{{leader.agencyLeaderType}}' e-type="get" datatype="*">
                                    </e-select>
                                </td>
                                <td align="center">
                                    <button
                                            e-permission="core_user_edit"
                                            type="button" class="btn btn-default"  e-event="href:/system/organization/delRow?row={{i}}"><i class="fa fa-remove"></i> 删除
                                    </button>
                                </td>
                            </tr>
                        {{/each}}
                    {{else}}
                        <tr id="leader_0">
                            <td>
                                <e-poptreelist id="leader_agency_0" name="leader_agency"
                                               e-tree-url="/system/organization/leader/list"
                                               e-list-url="/system/core/user/leader/list"
                                               e-option-value="account" e-option-text="name"
                                               e-option-text-title="名称"  e-title="选择本级领导"
                                               e-data-id="id" e-data-parent-id="pId"
                                               e-display-columns="account,name,orgName"
                                               e-display-columnnames="登录账户,用户名称,所属机构"
                                               e-chkbox-type="1"
                                               e-expand-level="0"
                                               e-z-index="99"
                                               e-width="1000px" e-height="650px" e-com-height="500px"
                                               e-query-param = "search_LIKE_name"
                                               e-query-param-name = "用户名称"
                                               e-query-tree-list-param = "id:search_LIKE_organization.orgPath"
                                               e-on-selected="/system/organization/leaderSelect?index=0"
                                >
                                </e-poptreelist>
                            </td>
                            <td>
                                <e-poptreelist id="leader_parent_0" name="leader_parent"
                                               e-tree-url="/system/core/post/list"
                                               e-list-url="/system/core/user/query"
                                               e-option-value="account" e-option-text="name"
                                               e-option-text-title="名称"  e-title="选择上级领导"
                                               e-data-id="id" e-data-parent-id="pId"
                                               e-display-columns="account,name"
                                               e-display-columnnames="登录账户,用户名称"
                                               e-chkbox-type="1"
                                               e-expand-level="0"
                                               e-z-index="99"
                                               e-width="1000px" e-height="650px" e-com-height="600px"
                                               e-query-param = "search_LIKE_name"
                                               e-query-param-name = "用户名称"
                                               e-query-tree-list-param = "code:postId"
                                               e-on-selected="/system/organization/addParentLeaderType?index=0"
                                >
                                </e-poptreelist>

                            </td>
                            <td>
                                <e-select id="leader_type_0" class="form-control" name="leaderType"  e-option-value="code" e-option-text="name" e-url="" e-value='sc' e-type="get" e-event="event:change,href:/comtest/test" datatype="*">
                                </e-select>
                            </td>
                            <td align="center">
                                <button
                                        e-permission="core_user_edit"
                                        type="button" class="btn btn-default"  e-event="href:/system/organization/delRow?row=0"><i class="fa fa-remove"></i> 删除
                                </button>
                            </td>
                        </tr>
                    {{/if}}
                    </tbody>

                </table>
            </div>
            <div class="box-footer col-sm-12">
                <button type="button" class="btn btn-success"
                        e-event="href:/system/organization/saveleaderset"  e-permission="core_organization_create">
                    <i class="fa fa-arrow-up"></i>&nbsp;&nbsp;保存设置
                </button>
                <button e-event="href:/system/organization/goBack?goUrl=/system/organization/add?contentId=list" class="btn btn-primary " id="back_btn"
                        type="button" title="返回">
                    <i class="fa fa-undo"></i>&nbsp;返回
                </button>
            </div>
        </div>
        <!-- /.col -->
    </div>

    <!-- Your Page Content Here -->

</section>
<script>

    /*  function fTrim(str)
      {
          alert(str);
          str=str.replace(/(^\s*)|(\s*$)/g, "");
          alert(str);
          return str;
      }*/

    <!-- /.content -->
</script>
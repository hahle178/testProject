import Module from "ezdev-pcview/base/Module";
import UserNav from "./common/layout/navbars/user/UserNav";
import LogoutNav from "./common/layout/navbars/logout/LogoutNav";
import DictionaryCache from "ezdev-pcview/cache/processor/DictionaryCache";
import config from "ezdev-pcview/Config";
import SidebarMenu from "ezdev-pcview/layout/sidebar/SidebarMenu";

new Module({
    name: "system",

    initModule:function(app) {
        if (!app.config.sidebarMenu) {
            app.config.sidebarMenu = new SidebarMenu();
        }
        console.info("系统管理模块【system】初始化完成！！！");
    },

    /**
     * 添加缓存
     * @param cacheManager
     */
    addCache: function (cacheManager) {
        cacheManager.add(new DictionaryCache(config.dictionaryUrl));
    },

    /**
     * 添加右上角导航栏
     * @param container
     */
    addNavbar:function(container) {
        //在右侧导航栏中添加登出按钮
        container.add(new LogoutNav());
        //在右侧导航栏中添加用户中心
        container.add(new UserNav());
    },

    /**
     * 动态导入Handler
     * @param path
     * @returns {*}
     */
    dynamicImportHandler: function (path) {
        try {
            return import(`./business/${path}/Handler.js`);
        } catch (err) {
            console.error("load handler error");
        }
    }
});